load("/Library/Frameworks/R.framework/Versions/2.7/Resources/library/rjags/Meta/package.rds")
load("/Library/Frameworks/R.framework/Versions/2.7/Resources/library/rjags/Meta/Rd.rds")
load("/Library/Frameworks/R.framework/Versions/2.7/Resources/library/rjags/Meta/hsearch.rds")
jags.model
jags.model()
library(rjags)
?rjags
library(rjags)
exit
exit()
quit()
(regexpr("RD[AX]2\n", magic) == -1L)
backtrace
backtrace()
trace()
bt
bt()
library(rjags)
ptr()
?rjags
apropos rjags
spotlight <- function(word) {#
        place <- paste(Sys.getenv("R_HOME"), "/library/", sep="")#
        string <- paste("mdfind -onlyin", place, word , " |", getOption("pager"))#
        system(string, intern=T)#
}
apropos("rjags")
spotlight("rjags")
?nlme
spotlight("nlme")
jags.model()
jags.model
jags.samples()
jags.samples
update
type
update
UseMethod
library(rjags)
ptr
model.update
jags.model
first
.first
First
.First
n <- 1000    # define sample size#
    set.seed(17) # so can reproduce the results#
    treat <- sample(c('a','b','c'), n, T)#
    num.diseases <- sample(0:4, n, T)#
    age <- rnorm(n, 50, 10)#
    cholesterol <- rnorm(n, 200, 25)#
    weight <- rnorm(n, 150, 20)#
    sex <- sample(c('female','male'), n, T)#
    label(age) <- 'Age'      # label is in Hmisc#
    label(num.diseases) <- 'Number of Comorbid Diseases'#
    label(cholesterol) <- 'Total Cholesterol'#
    label(weight) <- 'Weight, lbs.'#
    label(sex) <- 'Sex'#
    units(cholesterol) <- 'mg/dl'   # uses units.default in Hmisc#
#
    # Specify population model for log odds that Y=1#
    L <- .1*(num.diseases-2) + .045*(age-50) +#
      (log(cholesterol - 10)-5.2)*(-2*(treat=='a') +#
          3.5*(treat=='b')+2*(treat=='c'))#
    # Simulate binary y to have Prob(y=1) = 1/[1+exp(-L)]#
    y <- ifelse(runif(n) < plogis(L), 1, 0)
treat
summary(treat)
library(design)
library(Design)
?sample
num.diseases[1:10]
L
?plogis
y[1:10]
?logistic
glm()
glm(y ~ num.diseases)
glm(y ~ num.diseases, family="binomial")
glm(y ~ num.diseases + log(cholesterol-10) + age, family="binomial")
L <- .1*(num.diseases-2) + .045*(age-50)
 y <- ifelse(runif(n) < plogis(L), 1, 0)
glm(y ~ num.diseases +  age, family="binomial")
summary(log(cholosterol))
summary(log(cholesterol))
summary(log(cholesterol-10))
?Design
library(Design)
?Overview
44-16+1
library(nlme)
citation()
citation("nlme")
help.search(gls)
search(gls)
help.search("gls")
library(boa)
library(coda)
codamenu()
2019*.3
2019*.3*.6
2019*.3*.6*12/26
sqrt(1.5)
sqrt(1.7)
sqrt(1.9)
sqrt(1.8)
3000/32
5.9*64
8.7*50
+377.6
+377.6+435
60.59++5.3
60.59+5.3+21.99+179.56+4
44.25*12
# see end for an example code#
#
#
find.my.cells <- function(cell.counts, logor, var, #
					row1sum, row2sum, col1sum, col2sum) {#
	#
	# first equation: c11 + c12 = N1*#
	eq1 <- row.total.eq(cell.counts, row=1, total=row1sum)#
	#
	# second equation: c21 + c22 = N2*#
	eq2 <- row.total.eq(cell.counts, row=2, total=row2sum)#
#
	# third equation: c11 + c21 = N*1#
	eq3 <- col.total.eq(cell.counts, col=1, total=col1sum)#
	#
	# fourth equation: c12 + c22 = N*2#
	eq4 <- col.total.eq(cell.counts, col=2, total=col2sum)#
	#
	# fifth equation: log(c11*c22)-log(c12*c21) = logor#
	eq5 <- logor.eq(cell.counts, logor= logor)#
	#
	# sixth equation: 1/c11 + 1/c12 + 1/c21 + 1/c22 = var #
	eq6 <- var.eq(cell.counts, var = var)#
	#
	res <- eq1 + eq2 + eq3 + eq4 + eq5 + eq6#
	return(res)#
}#
#
#
#
row.total.eq <- function(cell.counts, row, total=NA) {#
	res <- cell.counts[(row-1)*2+1] + cell.counts[(row-1)*2+2]#
	if (is.na(total)) {#
		return(res)#
	}#
	else {#
		return((res-total)^2)#
	}#
	#
} #
#
#
col.total.eq <- function(cell.counts, col, total=NA) {#
	res <- cell.counts[col] + cell.counts[2+col]#
	if (is.na(total)) {#
		return(res)#
	}#
	else {#
		return((res-total)^2)#
	}#
	#
} #
#
#
logor.eq <- function(cell.counts, logor=NA, cc=0.5) {#
	if (cell.counts[1]*cell.counts[2]*cell.counts[3]*cell.counts[4] !=0) {#
		res <- log(cell.counts[1]*cell.counts[4]) -#
		       log(cell.counts[2]*cell.counts[3])#
	}#
	else {#
		res <- log(cell.counts[1]+cc) +  #
		       log(cell.counts[4]+cc) -#
		       log(cell.counts[2]+cc) -#
		       log(cell.counts[3]+cc)#
	}#
	#
	if (is.na(logor)) {#
		return(res)#
	}#
	else {#
		return((res - logor)^2)#
	}#
}#
	#
var.eq <- function(cell.counts, var=NA, cc=0.5) {#
	if (cell.counts[1]*cell.counts[2]*cell.counts[3]*cell.counts[4] >0) {#
		res <- 1/cell.counts[1] +#
		       1/cell.counts[2] +#
		       1/cell.counts[3] +#
		       1/cell.counts[4]#
	}#
	else {#
		res <- 1/(cell.counts[1]+cc) +#
			   1/(cell.counts[2]+cc) +#
			   1/(cell.counts[3]+cc) + #
			   1/(cell.counts[4]+cc)#
	}#
	if (is.na(var)) {#
		return(res)		#
	}#
	else {#
		return((res - var)^2)#
	}#
}#
#
#
var.sq.gradients <- function(cell.counts, var = NA) {#
	# returns partial first derivatives of squared variances #
#
	d1 <- -2 * var.eq(cell.counts, var=var) / cell.counts[1]^2#
	d2 <- -2 * var.eq(cell.counts, var=var) / cell.counts[2]^2#
	d3 <- -2 * var.eq(cell.counts, var=var) / cell.counts[3]^2#
	d4 <- -2 * var.eq(cell.counts, var=var) / cell.counts[4]^2#
	res <- c(d1,d2,d3,d4)#
	#
	return(res)#
}#
#
logor.sq.gradients <- function(cell.counts, logor = NA) {#
	# returns partial first derivatives of squared logor#
#
	d1 <-  2 * logor.eq(cell.counts, logor=logor) / cell.counts[1]#
	d2 <- -2 * logor.eq(cell.counts, logor=logor) / cell.counts[2]#
	d3 <- -2 * logor.eq(cell.counts, logor=logor) / cell.counts[3]#
	d4 <-  2 * logor.eq(cell.counts, logor=logor) / cell.counts[4]#
	#
	res <- c(d1,d2,d3,d4)#
	#
	return(res)#
}#
#
#
#
gradients<- function(cell.counts, logor, var, #
			row1sum, row2sum, col1sum, col2sum) {#
	# returns the gradients for the cell counts #
	# note that I have to create them from the #
	# six components of the #
	# objective function. 	#
	#
	r1sum.part <- c(0, 0, 0, 0)#
	r1sum.part[c(1,2)] <- 2* (sum(cell.counts[c(1,2)]) - row1sum)#
#
	r2sum.part <- c(0, 0, 0, 0)#
	r2sum.part[c(3,4)] <- 2* (sum(cell.counts[c(3,4)]) - row2sum)#
#
	c1sum.part <- c(0, 0, 0, 0)#
	c1sum.part[c(1,3)] <- 2* (sum(cell.counts[c(1,3)]) - col1sum)#
#
	c2sum.part <- c(0, 0, 0, 0)#
	c2sum.part[c(2,4)] <- 2* (sum(cell.counts[c(2,4)]) - col2sum)#
#
	variance.part <- var.sq.gradients(cell.counts, var = var)#
	logor.part <- logor.sq.gradients(cell.counts, logor = logor)#
	#
	res <- r1sum.part + r2sum.part + c1sum.part + c2sum.part +#
		   variance.part + logor.part #
	#
	return(res)#
}#
#
#
#
#
##############################################
###  binary data #
##############################################
#
# assume that you get the following#
# c11, c12, c21, c22 #
# r1sum = c11 + c12#
# r2sum = c21 + c22#
# c1sum = c11 + c21#
# c2sum = c12 + c22#
# N = c11+c12+c13+c14#
#
#
#
#
#
#
#
#
#
#
#
#
#
#############################################
#
# make a fictitious 2x2#
a <- c(1001, 20, 300, 40)#
# calculate the logor and the variance #
my.logor <- logor.eq(a, logor=NA)#
my.var <- var.eq(a, var=NA)#
my.row1sum <- sum(a[c(1,2)])#
my.row2sum <- sum(a[c(3,4)])#
my.col1sum <- sum(a[c(1,3)])#
my.col2sum <- sum(a[c(2,4)])#
my.total <- sum(a)#
#
result.NM<-optim(rep(my.total/4,4), find.my.cells, gr=NULL, logor=my.logor,var=my.var,#
	row1sum=my.row1sum, row2sum =my.row2sum, col1sum=my.col1sum, col2sum=my.col2sum,#
	method = "Nelder-Mead",#
	control=c(abstol=1e-8, maxit=10000, reltol=0))#
#
result.NM#
#
round(result.NM$par)#
#
#
#result.BFGS<-optim(rep(my.total/4,4), find.my.cells, gradients, logor=my.logor,var=my.var,#
#	row1sum=my.row1sum, row2sum =my.row2sum, col1sum=my.col1sum, col2sum=my.col2sum,#
#	method = "BFGS",#
#	control=c(abstol=1e-8, maxit=10000, reltol=0))#
##
#result.BFGS#
##
#round(result.BFGS$par)
#
# make a fictitious 2x2#
a <- c(1001, 20, 300, 40)#
# calculate the logor and the variance #
my.logor <- logor.eq(a, logor=NA)#
my.var <- var.eq(a, var=NA)#
my.row1sum <- sum(a[c(1,2)])#
my.row2sum <- sum(a[c(3,4)])#
my.col1sum <- sum(a[c(1,3)])#
my.col2sum <- sum(a[c(2,4)])#
my.total <- sum(a)#
#
result.NM<-optim(rep(my.total/4,4), find.my.cells, gr=NULL, logor=my.logor,var=my.var,#
	row1sum=my.row1sum, row2sum =my.row2sum, col1sum=my.col1sum, col2sum=my.col2sum,#
	method = "Nelder-Mead",#
	control=c(abstol=1e-8, maxit=10000, reltol=0))#
#
result.NM#
#
round(result.NM$par)
#
# make a fictitious 2x2#
a <- c(2001, 20, 300, 40)#
# calculate the logor and the variance #
my.logor <- logor.eq(a, logor=NA)#
my.var <- var.eq(a, var=NA)#
my.row1sum <- sum(a[c(1,2)])#
my.row2sum <- sum(a[c(3,4)])#
my.col1sum <- sum(a[c(1,3)])#
my.col2sum <- sum(a[c(2,4)])#
my.total <- sum(a)#
#
result.NM<-optim(rep(my.total/4,4), find.my.cells, gr=NULL, logor=my.logor,var=my.var,#
	row1sum=my.row1sum, row2sum =my.row2sum, col1sum=my.col1sum, col2sum=my.col2sum,#
	method = "Nelder-Mead",#
	control=c(abstol=1e-8, maxit=10000, reltol=0))#
#
result.NM#
#
round(result.NM$par)
506.50+130.62
1813.5-853.5
1317.97-960
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,6)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],6))#
#
	X<- (#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res)#
}
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,6)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],6))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res, my.frame)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	print()my.frame)#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res, my.frame)#
}
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	print(my.frame)#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res, my.frame)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
?colnames
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	colnames(my.frame) <- c("c11", "c12", "c21", "c22", "r1sum", "r2sum", "c1sum", "c2sum", "total" )#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
?lm
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	colnames(my.frame) <- c("c11", "c12", "c21", "c22", "r1sum", "r2sum", "c1sum", "c2sum", "total" )#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit )#
	#
	return(res)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	colnames(my.frame) <- c("c11", "c12", "c21", "c22", "r1sum", "r2sum", "c1sum", "c2sum", "total" )#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame)#
	#
	return(res)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=10)
fillin.2x2.simple(c11=1,c12=1,c21=1)
fillin.2x2.simple(c11=1,c12=1,c21=1, total=5)
fillin.2x2.simple(c11=1,c12=1, total=5)
library(igraph)
??igraph
1908
1908+1933
3841*6
5000/12
3000*26
-14400
78000-14400
/12
78000/12-14400/12
140000/26
140000/12
140000/26
130000/26
130000*.40
140/13
140/130
140/133
140/133 * 3000
3*26/12
6.5-3.2
706 *26
16500/26
45000*1.03^4
3000*26
28000
28000/12
2300+1200
32000
/12
32000/12
32000/12 + 1200
32000/12 + 1200 -3200
700 * 12/26
28000/12 + 1200 -3200
110000
110000/14000
110000/140000
400/.79
140000*1.03^5
3200 * .97^5
123.70+50+12.62+224.74
247.40+36+168.17
247.40+36+168.17+20.67+50
cdf()
source('01_example.r')
get.vertex.index.from.attribute()
get.vertex.index.from.attribute(G, 'pmid', 16154181)
get.vertex.index.from.attribute(G, 'pmid', '16154181')
get.vertex.index.from.attribute(G, '16154181')
get.vertex.attribute(G, 'title', 390)
is.acyclic <- function(G) {#
    order <- diameter(G)#
    acyclic <- TRUE#
    for (v in 0:(length(V(G))-1)) {#
        v.in <- neighborhood(G, order, v, mode='in')[[1]]#
        v.out <- neighborhood(G, order, v, mode='out')[[1]]#
        #
        for (v1 in 1:length(v.in)) {#
            for (v2 in 1:length(v.out)) {#
                if ((v1==v2) & (v1!=v)) {#
                    cat("Found cyclic path for node", v, '!\n')#
                    acyclic <- FALSE#
                    break#
                }#
            }#
        }#
    }#
    #
    return(acyclic)#
}
is.acyclic(G)
neighborhood(G, 7, 0, mode='in')[[1]]
neighborhood(G, 7, 0, mode='out')[[1]]
(1==1)
neighborhood(G, 7, 881, mode='out')[[1]]
neighborhood(G, 7, 881, mode='in')[[1]]
is.acyclic <- function(G) {#
    order <- diameter(G)#
    acyclic <- TRUE#
    for (v in 0:(length(V(G))-1)) {#
        v.in <- neighborhood(G, order, v, mode='in')[[1]]#
        v.out <- neighborhood(G, order, v, mode='out')[[1]]#
        n.in <- length(v.in)#
        n.out <- length(v.out)#
        #
        if ((n.in>1) & (n.out>1)) {       # if only the index node in up or down, no problem#
            for (v1 in 2:length(v.in)) {  # the first element is always the index node#
                for (v2 in 2:length(v.out)) {#
                    if ((v1==v2)) {#
                        cat("Found cyclic path for node", v, '!\n')#
                        acyclic <- FALSE#
                        break#
                    }#
                }#
            }            #
        }   #
    }#
    return(acyclic)#
}
neighborhood(G, 7, 881, mode='in')[[1]]
is.acyclic(G)
neighborhood(G, 7, 3, mode='in')[[1]]
neighborhood(G, 7, 3, mode='out')[[1]]
is.acyclic <- function(G) {#
    order <- diameter(G)#
    acyclic <- TRUE#
    for (v in 0:(length(V(G))-1)) {#
        v.in <- neighborhood(G, order, v, mode='in')[[1]]#
        v.out <- neighborhood(G, order, v, mode='out')[[1]]#
        n.in <- length(v.in)#
        n.out <- length(v.out)#
        #
        if ((n.in>1) & (n.out>1)) {       # if only the index node in up or down, no problem#
            for (v1 in 2:length(v.in)) {  # the first element is always the index node#
                for (v2 in 2:length(v.out)) {#
                    if ((v.in[v1]==v.out[v2])) {#
                        cat("Found cyclic path for node", v, '!\n')#
                        acyclic <- FALSE#
                        break#
                    }#
                }#
            }            #
        }   #
    }#
    return(acyclic)#
}
neighborhood(G, 7, 3, mode='out')[[1]]
is.acyclic(G)
neighborhood(G, 7, 401, mode='out')[[1]]
neighborhood(G, 7, 401, mode='in')[[1]]
ga <- subgraph(G, c(401,402,403))
plot(ga)
ga
get.vertex.attributes(ga, pmid)
get.vertex.attribute(ga, 'pmid')
get.vertex.attribute(ga, 'title')
get.vertex.attribute(ga, 'year')
ma <- get.adjacency(ga)
ma
M <- get.adjacency(G)
M[401, 402]
M[402, 402]
M[401, 403]
M[401, 403]is.acyclic
is.acyclic(ga)
?remove.edge
?remove.edges
?edges
?igraph
is.acyclic <- function(G) {#
    order <- diameter(G)#
    acyclic <- TRUE#
    for (v in 0:(length(V(G))-1)) {#
        v.in <- neighborhood(G, order, v, mode='in')[[1]]#
        v.out <- neighborhood(G, order, v, mode='out')[[1]]#
        n.in <- length(v.in)#
        n.out <- length(v.out)#
        #
        if ((n.in>1) & (n.out>1)) {       # if only the index node in the 'in' or 'out', no problem#
            for (v1 in 2:length(v.in)) {  # the first element is always the index node#
                for (v2 in 2:length(v.out)) {#
                    if ((v.in[v1]==v.out[v2])) {#
                        cat("Found cyclic path for node", v, '!\n')#
                        acyclic <- FALSE#
                        return(acyclic)#
                    }#
                }#
            }            #
        }   #
    }#
    return(acyclic)#
}
is.acyclic(ga)
is.acyclic <- function(G) {#
    order <- diameter(G)#
    acyclic <- TRUE#
    for (v in 0:(length(V(G))-1)) {#
        v.in <- neighborhood(G, order, v, mode='in')[[1]]#
        v.out <- neighborhood(G, order, v, mode='out')[[1]]#
        n.in <- length(v.in)#
        n.out <- length(v.out)#
        #
        if ((n.in>1) & (n.out>1)) {       # if only the index node in the 'in' or 'out', no problem#
            for (v1 in 2:length(v.in)) {  # the first element is always the index node#
                for (v2 in 2:length(v.out)) {#
                    if ((v.in[v1]==v.out[v2])) {#
                        cat("Found cyclic path for node", v, '!\n')#
                        cat("incoming:", v.in[2:n.in], '\n')#
                        cat("outgoing:", v.out[2:n.out], '\n')#
                        acyclic <- FALSE#
                        return(acyclic)#
                    }#
                }#
            }            #
        }   #
    }#
    return(acyclic)#
}
is.acyclic(ga)
is.acyclic(G)
E(ga)
E(ga, 1)
E(ga, c(1,2))
E(ga, c(1,2, 0,1))
delete.edges(ga, E(ga, c(1,2, 0,1)))
delete.edges(ga, E(ga, c(1,2, 0,1))) -> gb
is.acyclic(gb)
delete.edges(ga, E(ga, c(1,2, 0,1, 0,2))) -> gb
is.acyclic(gb)
delete.edges(G, E(G, c(401, 402, 401, 403, 402, 403)))
delete.edges(G, E(G, c(401, 402, 401, 403, 402, 403))) -> G1
is.acyclic(G1)
#
is.acyclic <- function(G) {#
    order <- diameter(G)#
    acyclic <- TRUE#
    for (v in 0:(length(V(G))-1)) {#
        v.in <- neighborhood(G, order, v, mode='in')[[1]]#
        v.out <- neighborhood(G, order, v, mode='out')[[1]]#
        n.in <- length(v.in)#
        n.out <- length(v.out)#
        #
        if ((n.in>1) & (n.out>1)) {       # if only the index node in the 'in' or 'out', no problem#
            for (v1 in 2:length(v.in)) {  # the first element is always the index node#
                for (v2 in 2:length(v.out)) {#
                    if ((v.in[v1]==v.out[v2])) {#
                        cat("Found cyclic path for node", v, '!\n')#
                        cat("incoming:", v.in[2:n.in], '\n')#
                        cat("outgoing:", v.out[2:n.out], '\n')#
                        acyclic <- FALSE#
                        return(acyclic)#
                    }#
                }#
            }            #
        }   #
    }#
    return(acyclic)#
}#
#
#
write.pajek.file <- function(G,filename,twomode=1){#
    #
    M <- get.adjacency(G)#
    rownames(M) <- seq(0, dim(M)[1]) #
    if ((dim(M)[1] == dim(M)[2]) & (twomode!=2)) {#
        write(paste("*Vertices",dim(M)[1]), file = filename);#
        write(paste(seq(1,length=dim(M)[1]),' "',rownames(M),#
            '"',sep=""), file = filename,append=TRUE);#
        write("*Arcs", file = filename,append=TRUE);#
        for (i in 1:dim(M)[1]) {#
            for (j in 1:dim(M)[2]) {#
                if (M[i,j]!=0) {#
                    write(paste(i,j,M[i,j]),#
                        file = filename,append=TRUE)#
                }#
            }#
        }#
    } #
#    else {#
#        write(paste("*Vertices",sum(dim(M)),dim(M)[1]),#
#            file = filename);#
#        write(paste(1:dim(M)[1],' "',rownames(M),'"',sep=""),#
#            file = filename,append=TRUE);#
#        write(paste(seq(dim(M)[1]+1,length=dim(M)[2]),' "',#
#            colnames(M),'"',sep=""), file = filename,append=TRUE);#
#        write("*Edges", file = filename, append=TRUE);#
#        for (i in 1:dim(M)[1]) {#
#            for (j in 1:dim(M)[2]) {#
#                if (M[i,j]!=0) {#
#                    write(paste(i,j+dim(M)[1],M[i,j]),#
#                        file = filename,append=TRUE)#
#                }#
#            }#
#        }#
#    }#
}
is.acyclic(G1)
save.pajek.file(G, 'lala.mat')
write.pajek.file(G, 'lala.mat')
write.pajek.file(G, 'lala.mat')write.pajek.file <- function(G,filename,twomode=1){#
    #
    M <- get.adjacency(G)#
    rownames(M) <- seq(0, dim(M)[1]-1) #
    if ((dim(M)[1] == dim(M)[2]) & (twomode!=2)) {#
        write(paste("*Vertices",dim(M)[1]), file = filename);#
        write(paste(seq(1,length=dim(M)[1]),' "',rownames(M),#
            '"',sep=""), file = filename,append=TRUE);#
        write("*Arcs", file = filename,append=TRUE);#
        for (i in 1:dim(M)[1]) {#
            for (j in 1:dim(M)[2]) {#
                if (M[i,j]!=0) {#
                    write(paste(i,j,M[i,j]),#
                        file = filename,append=TRUE)#
                }#
            }#
        }#
    } #
#    else {#
#        write(paste("*Vertices",sum(dim(M)),dim(M)[1]),#
#            file = filename);#
#        write(paste(1:dim(M)[1],' "',rownames(M),'"',sep=""),#
#            file = filename,append=TRUE);#
#        write(paste(seq(dim(M)[1]+1,length=dim(M)[2]),' "',#
#            colnames(M),'"',sep=""), file = filename,append=TRUE);#
#        write("*Edges", file = filename, append=TRUE);#
#        for (i in 1:dim(M)[1]) {#
#            for (j in 1:dim(M)[2]) {#
#                if (M[i,j]!=0) {#
#                    write(paste(i,j+dim(M)[1],M[i,j]),#
#                        file = filename,append=TRUE)#
#                }#
#            }#
#        }#
#    }#
}
write.pajek.file <- function(G,filename,twomode=1){#
    #
    M <- get.adjacency(G)#
    rownames(M) <- seq(0, dim(M)[1]-1) #
    if ((dim(M)[1] == dim(M)[2]) & (twomode!=2)) {#
        write(paste("*Vertices",dim(M)[1]), file = filename);#
        write(paste(seq(1,length=dim(M)[1]),' "',rownames(M),#
            '"',sep=""), file = filename,append=TRUE);#
        write("*Arcs", file = filename,append=TRUE);#
        for (i in 1:dim(M)[1]) {#
            for (j in 1:dim(M)[2]) {#
                if (M[i,j]!=0) {#
                    write(paste(i,j,M[i,j]),#
                        file = filename,append=TRUE)#
                }#
            }#
        }#
    } #
#    else {#
#        write(paste("*Vertices",sum(dim(M)),dim(M)[1]),#
#            file = filename);#
#        write(paste(1:dim(M)[1],' "',rownames(M),'"',sep=""),#
#            file = filename,append=TRUE);#
#        write(paste(seq(dim(M)[1]+1,length=dim(M)[2]),' "',#
#            colnames(M),'"',sep=""), file = filename,append=TRUE);#
#        write("*Edges", file = filename, append=TRUE);#
#        for (i in 1:dim(M)[1]) {#
#            for (j in 1:dim(M)[2]) {#
#                if (M[i,j]!=0) {#
#                    write(paste(i,j+dim(M)[1],M[i,j]),#
#                        file = filename,append=TRUE)#
#                }#
#            }#
#        }#
#    }#
}
write.pajek.file(G, 'lala.mat')
write.pajek.file(G1, 'lala.mat')
getwd()
get.vertex.attribute(G, 'pmid')
get.vertex.attribute(G, 'pmid')
write.pajek.file <- function(G,filename,twomode=1){#
    #
    M <- get.adjacency(G)#
    rownames(M) <- get.vertex.attribute(G, 'pmid')#
    if ((dim(M)[1] == dim(M)[2]) & (twomode!=2)) {#
        write(paste("*Vertices",dim(M)[1]), file = filename);#
        write(paste(seq(1,length=dim(M)[1]),' "',rownames(M),#
            '"',sep=""), file = filename,append=TRUE);#
        write("*Arcs", file = filename,append=TRUE);#
        for (i in 1:dim(M)[1]) {#
            for (j in 1:dim(M)[2]) {#
                if (M[i,j]!=0) {#
                    write(paste(i,j,M[i,j]),#
                        file = filename,append=TRUE)#
                }#
            }#
        }#
    } #
#    else {#
#        write(paste("*Vertices",sum(dim(M)),dim(M)[1]),#
#            file = filename);#
#        write(paste(1:dim(M)[1],' "',rownames(M),'"',sep=""),#
#            file = filename,append=TRUE);#
#        write(paste(seq(dim(M)[1]+1,length=dim(M)[2]),' "',#
#            colnames(M),'"',sep=""), file = filename,append=TRUE);#
#        write("*Edges", file = filename, append=TRUE);#
#        for (i in 1:dim(M)[1]) {#
#            for (j in 1:dim(M)[2]) {#
#                if (M[i,j]!=0) {#
#                    write(paste(i,j+dim(M)[1],M[i,j]),#
#                        file = filename,append=TRUE)#
#                }#
#            }#
#        }#
#    }#
}
write.pajek.file(G, 'lala.mat')
write.pajek.file <- function(G,filename,pmid=TRUE,twomode=1){#
    #
    M <- get.adjacency(G)#
    if (pmid==TRUE) {#
        rownames(M) <- get.vertex.attribute(G, 'pmid')#
    }#
    else {#
        rownames(M) <- seq(0, dim(M)[1]-1)#
    }#
    if ((dim(M)[1] == dim(M)[2]) & (twomode!=2)) {#
        write(paste("*Vertices",dim(M)[1]), file = filename);#
        write(paste(seq(1,length=dim(M)[1]),' "',rownames(M),#
            '"',sep=""), file = filename,append=TRUE);#
        write("*Arcs", file = filename,append=TRUE);#
        for (i in 1:dim(M)[1]) {#
            for (j in 1:dim(M)[2]) {#
                if (M[i,j]!=0) {#
                    write(paste(i,j,M[i,j]),#
                        file = filename,append=TRUE)#
                }#
            }#
        }#
    } #
#    else {#
#        write(paste("*Vertices",sum(dim(M)),dim(M)[1]),#
#            file = filename);#
#        write(paste(1:dim(M)[1],' "',rownames(M),'"',sep=""),#
#            file = filename,append=TRUE);#
#        write(paste(seq(dim(M)[1]+1,length=dim(M)[2]),' "',#
#            colnames(M),'"',sep=""), file = filename,append=TRUE);#
#        write("*Edges", file = filename, append=TRUE);#
#        for (i in 1:dim(M)[1]) {#
#            for (j in 1:dim(M)[2]) {#
#                if (M[i,j]!=0) {#
#                    write(paste(i,j+dim(M)[1],M[i,j]),#
#                        file = filename,append=TRUE)#
#                }#
#            }#
#        }#
#    }#
}
write.pajek.file(G, 'lala.mat', pmid=FALSE)
write.pajek.file <- function(G,filename,name='pmid',twomode=1){#
    #
    M <- get.adjacency(G)#
    if (name!= NULL) {#
        rownames(M) <- get.vertex.attribute(G, name)#
    }#
    else {#
        rownames(M) <- paste('v',seq(0, dim(M)[1]-1), sep='')#
    }#
    if ((dim(M)[1] == dim(M)[2]) & (twomode!=2)) {#
        write(paste("*Vertices",dim(M)[1]), file = filename);#
        write(paste(seq(1,length=dim(M)[1]),' "',rownames(M),#
            '"',sep=""), file = filename,append=TRUE);#
        write("*Arcs", file = filename,append=TRUE);#
        for (i in 1:dim(M)[1]) {#
            for (j in 1:dim(M)[2]) {#
                if (M[i,j]!=0) {#
                    write(paste(i,j,M[i,j]),#
                        file = filename,append=TRUE)#
                }#
            }#
        }#
    } #
#    else {#
#        write(paste("*Vertices",sum(dim(M)),dim(M)[1]),#
#            file = filename);#
#        write(paste(1:dim(M)[1],' "',rownames(M),'"',sep=""),#
#            file = filename,append=TRUE);#
#        write(paste(seq(dim(M)[1]+1,length=dim(M)[2]),' "',#
#            colnames(M),'"',sep=""), file = filename,append=TRUE);#
#        write("*Edges", file = filename, append=TRUE);#
#        for (i in 1:dim(M)[1]) {#
#            for (j in 1:dim(M)[2]) {#
#                if (M[i,j]!=0) {#
#                    write(paste(i,j+dim(M)[1],M[i,j]),#
#                        file = filename,append=TRUE)#
#                }#
#            }#
#        }#
#    }#
}#
#
#
#
#
get.vertex.index.from.attribute <- function(G, attribute.value, attribute.name = 'pmid'){#
    vertices <- V(G)#
    for (i in 0:(length(vertices)-1)){#
        att <- get.vertex.attribute(G, attribute.name, i)#
        if ((att == attribute.value)){#
            return(i)#
        }#
    }#
    #
    cat("Found no vertex with the specified attribute\n")#
    return(NULL)#
}
write.pajek.file(G, 'lala.mat' name=NULL)
write.pajek.file <- function(G,filename,name='pmid',twomode=1){#
    #
    M <- get.adjacency(G)#
    if (name != NULL) {#
        rownames(M) <- get.vertex.attribute(G, name)#
    }#
    else {#
        rownames(M) <- paste('v',seq(0, dim(M)[1]-1), sep='')#
    }#
    if ((dim(M)[1] == dim(M)[2]) & (twomode!=2)) {#
        write(paste("*Vertices",dim(M)[1]), file = filename);#
        write(paste(seq(1,length=dim(M)[1]),' "',rownames(M),#
            '"',sep=""), file = filename,append=TRUE);#
        write("*Arcs", file = filename,append=TRUE);#
        for (i in 1:dim(M)[1]) {#
            for (j in 1:dim(M)[2]) {#
                if (M[i,j]!=0) {#
                    write(paste(i,j,M[i,j]),#
                        file = filename,append=TRUE)#
                }#
            }#
        }#
    } #
#    else {#
#        write(paste("*Vertices",sum(dim(M)),dim(M)[1]),#
#            file = filename);#
#        write(paste(1:dim(M)[1],' "',rownames(M),'"',sep=""),#
#            file = filename,append=TRUE);#
#        write(paste(seq(dim(M)[1]+1,length=dim(M)[2]),' "',#
#            colnames(M),'"',sep=""), file = filename,append=TRUE);#
#        write("*Edges", file = filename, append=TRUE);#
#        for (i in 1:dim(M)[1]) {#
#            for (j in 1:dim(M)[2]) {#
#                if (M[i,j]!=0) {#
#                    write(paste(i,j+dim(M)[1],M[i,j]),#
#                        file = filename,append=TRUE)#
#                }#
#            }#
#        }#
#    }#
}
write.pajek.file(G, 'lala.mat' name=NULL)
write.pajek.file(G, 'lala.mat' ,name=NULL)
a = NULL
is.null(a)
write.pajek.file <- function(G,filename,name='pmid',twomode=1){#
    #
    M <- get.adjacency(G)#
    if (is.null(name)) {#
        rownames(M) <- get.vertex.attribute(G, name)#
    }#
    else {#
        rownames(M) <- paste('v',seq(0, dim(M)[1]-1), sep='')#
    }#
    if ((dim(M)[1] == dim(M)[2]) & (twomode!=2)) {#
        write(paste("*Vertices",dim(M)[1]), file = filename);#
        write(paste(seq(1,length=dim(M)[1]),' "',rownames(M),#
            '"',sep=""), file = filename,append=TRUE);#
        write("*Arcs", file = filename,append=TRUE);#
        for (i in 1:dim(M)[1]) {#
            for (j in 1:dim(M)[2]) {#
                if (M[i,j]!=0) {#
                    write(paste(i,j,M[i,j]),#
                        file = filename,append=TRUE)#
                }#
            }#
        }#
    } #
#    else {#
#        write(paste("*Vertices",sum(dim(M)),dim(M)[1]),#
#            file = filename);#
#        write(paste(1:dim(M)[1],' "',rownames(M),'"',sep=""),#
#            file = filename,append=TRUE);#
#        write(paste(seq(dim(M)[1]+1,length=dim(M)[2]),' "',#
#            colnames(M),'"',sep=""), file = filename,append=TRUE);#
#        write("*Edges", file = filename, append=TRUE);#
#        for (i in 1:dim(M)[1]) {#
#            for (j in 1:dim(M)[2]) {#
#                if (M[i,j]!=0) {#
#                    write(paste(i,j+dim(M)[1],M[i,j]),#
#                        file = filename,append=TRUE)#
#                }#
#            }#
#        }#
#    }#
}
write.pajek.file(G, 'lala.mat' ,name=NULL)
write.pajek.file <- function(G,filename,name='pmid',twomode=1){#
    #
    M <- get.adjacency(G)#
    if (is.null(name)==FALSE) {#
        rownames(M) <- get.vertex.attribute(G, name)#
    }#
    else {#
        rownames(M) <- paste('v',seq(0, dim(M)[1]-1), sep='')#
    }#
    if ((dim(M)[1] == dim(M)[2]) & (twomode!=2)) {#
        write(paste("*Vertices",dim(M)[1]), file = filename);#
        write(paste(seq(1,length=dim(M)[1]),' "',rownames(M),#
            '"',sep=""), file = filename,append=TRUE);#
        write("*Arcs", file = filename,append=TRUE);#
        for (i in 1:dim(M)[1]) {#
            for (j in 1:dim(M)[2]) {#
                if (M[i,j]!=0) {#
                    write(paste(i,j,M[i,j]),#
                        file = filename,append=TRUE)#
                }#
            }#
        }#
    } #
#    else {#
#        write(paste("*Vertices",sum(dim(M)),dim(M)[1]),#
#            file = filename);#
#        write(paste(1:dim(M)[1],' "',rownames(M),'"',sep=""),#
#            file = filename,append=TRUE);#
#        write(paste(seq(dim(M)[1]+1,length=dim(M)[2]),' "',#
#            colnames(M),'"',sep=""), file = filename,append=TRUE);#
#        write("*Edges", file = filename, append=TRUE);#
#        for (i in 1:dim(M)[1]) {#
#            for (j in 1:dim(M)[2]) {#
#                if (M[i,j]!=0) {#
#                    write(paste(i,j+dim(M)[1],M[i,j]),#
#                        file = filename,append=TRUE)#
#                }#
#            }#
#        }#
#    }#
}
write.pajek.file(G, 'lala.mat' ,name=NULL)
