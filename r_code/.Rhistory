library(rjags)
?rjags
? rjags()
?rjags
rjags
rjags/Library/Frameworks/R.framework/Versions/2.7/Resources/library/rjags/man/rjags.Rd
/Library/Frameworks/R.framework/Versions/2.7/Resources/library/rjags/man/rjags.Rd
load("/Library/Frameworks/R.framework/Versions/2.7/Resources/library/rjags/Meta/package.rds")
load("/Library/Frameworks/R.framework/Versions/2.7/Resources/library/rjags/Meta/Rd.rds")
load("/Library/Frameworks/R.framework/Versions/2.7/Resources/library/rjags/Meta/hsearch.rds")
jags.model
jags.model()
library(rjags)
?rjags
library(rjags)
exit
exit()
quit()
(regexpr("RD[AX]2\n", magic) == -1L)
backtrace
backtrace()
trace()
bt
bt()
library(rjags)
ptr()
?rjags
apropos rjags
spotlight <- function(word) {#
        place <- paste(Sys.getenv("R_HOME"), "/library/", sep="")#
        string <- paste("mdfind -onlyin", place, word , " |", getOption("pager"))#
        system(string, intern=T)#
}
apropos("rjags")
spotlight("rjags")
?nlme
spotlight("nlme")
jags.model()
jags.model
jags.samples()
jags.samples
update
type
update
UseMethod
library(rjags)
ptr
model.update
jags.model
first
.first
First
.First
n <- 1000    # define sample size#
    set.seed(17) # so can reproduce the results#
    treat <- sample(c('a','b','c'), n, T)#
    num.diseases <- sample(0:4, n, T)#
    age <- rnorm(n, 50, 10)#
    cholesterol <- rnorm(n, 200, 25)#
    weight <- rnorm(n, 150, 20)#
    sex <- sample(c('female','male'), n, T)#
    label(age) <- 'Age'      # label is in Hmisc#
    label(num.diseases) <- 'Number of Comorbid Diseases'#
    label(cholesterol) <- 'Total Cholesterol'#
    label(weight) <- 'Weight, lbs.'#
    label(sex) <- 'Sex'#
    units(cholesterol) <- 'mg/dl'   # uses units.default in Hmisc#
#
    # Specify population model for log odds that Y=1#
    L <- .1*(num.diseases-2) + .045*(age-50) +#
      (log(cholesterol - 10)-5.2)*(-2*(treat=='a') +#
          3.5*(treat=='b')+2*(treat=='c'))#
    # Simulate binary y to have Prob(y=1) = 1/[1+exp(-L)]#
    y <- ifelse(runif(n) < plogis(L), 1, 0)
treat
summary(treat)
library(design)
library(Design)
?sample
num.diseases[1:10]
L
?plogis
y[1:10]
?logistic
glm()
glm(y ~ num.diseases)
glm(y ~ num.diseases, family="binomial")
glm(y ~ num.diseases + log(cholesterol-10) + age, family="binomial")
L <- .1*(num.diseases-2) + .045*(age-50)
 y <- ifelse(runif(n) < plogis(L), 1, 0)
glm(y ~ num.diseases +  age, family="binomial")
summary(log(cholosterol))
summary(log(cholesterol))
summary(log(cholesterol-10))
?Design
library(Design)
?Overview
44-16+1
library(nlme)
citation()
citation("nlme")
help.search(gls)
search(gls)
help.search("gls")
library(boa)
library(coda)
codamenu()
2019*.3
2019*.3*.6
2019*.3*.6*12/26
sqrt(1.5)
sqrt(1.7)
sqrt(1.9)
sqrt(1.8)
3000/32
5.9*64
8.7*50
+377.6
+377.6+435
60.59++5.3
60.59+5.3+21.99+179.56+4
44.25*12
# see end for an example code#
#
#
find.my.cells <- function(cell.counts, logor, var, #
					row1sum, row2sum, col1sum, col2sum) {#
	#
	# first equation: c11 + c12 = N1*#
	eq1 <- row.total.eq(cell.counts, row=1, total=row1sum)#
	#
	# second equation: c21 + c22 = N2*#
	eq2 <- row.total.eq(cell.counts, row=2, total=row2sum)#
#
	# third equation: c11 + c21 = N*1#
	eq3 <- col.total.eq(cell.counts, col=1, total=col1sum)#
	#
	# fourth equation: c12 + c22 = N*2#
	eq4 <- col.total.eq(cell.counts, col=2, total=col2sum)#
	#
	# fifth equation: log(c11*c22)-log(c12*c21) = logor#
	eq5 <- logor.eq(cell.counts, logor= logor)#
	#
	# sixth equation: 1/c11 + 1/c12 + 1/c21 + 1/c22 = var #
	eq6 <- var.eq(cell.counts, var = var)#
	#
	res <- eq1 + eq2 + eq3 + eq4 + eq5 + eq6#
	return(res)#
}#
#
#
#
row.total.eq <- function(cell.counts, row, total=NA) {#
	res <- cell.counts[(row-1)*2+1] + cell.counts[(row-1)*2+2]#
	if (is.na(total)) {#
		return(res)#
	}#
	else {#
		return((res-total)^2)#
	}#
	#
} #
#
#
col.total.eq <- function(cell.counts, col, total=NA) {#
	res <- cell.counts[col] + cell.counts[2+col]#
	if (is.na(total)) {#
		return(res)#
	}#
	else {#
		return((res-total)^2)#
	}#
	#
} #
#
#
logor.eq <- function(cell.counts, logor=NA, cc=0.5) {#
	if (cell.counts[1]*cell.counts[2]*cell.counts[3]*cell.counts[4] !=0) {#
		res <- log(cell.counts[1]*cell.counts[4]) -#
		       log(cell.counts[2]*cell.counts[3])#
	}#
	else {#
		res <- log(cell.counts[1]+cc) +  #
		       log(cell.counts[4]+cc) -#
		       log(cell.counts[2]+cc) -#
		       log(cell.counts[3]+cc)#
	}#
	#
	if (is.na(logor)) {#
		return(res)#
	}#
	else {#
		return((res - logor)^2)#
	}#
}#
	#
var.eq <- function(cell.counts, var=NA, cc=0.5) {#
	if (cell.counts[1]*cell.counts[2]*cell.counts[3]*cell.counts[4] >0) {#
		res <- 1/cell.counts[1] +#
		       1/cell.counts[2] +#
		       1/cell.counts[3] +#
		       1/cell.counts[4]#
	}#
	else {#
		res <- 1/(cell.counts[1]+cc) +#
			   1/(cell.counts[2]+cc) +#
			   1/(cell.counts[3]+cc) + #
			   1/(cell.counts[4]+cc)#
	}#
	if (is.na(var)) {#
		return(res)		#
	}#
	else {#
		return((res - var)^2)#
	}#
}#
#
#
var.sq.gradients <- function(cell.counts, var = NA) {#
	# returns partial first derivatives of squared variances #
#
	d1 <- -2 * var.eq(cell.counts, var=var) / cell.counts[1]^2#
	d2 <- -2 * var.eq(cell.counts, var=var) / cell.counts[2]^2#
	d3 <- -2 * var.eq(cell.counts, var=var) / cell.counts[3]^2#
	d4 <- -2 * var.eq(cell.counts, var=var) / cell.counts[4]^2#
	res <- c(d1,d2,d3,d4)#
	#
	return(res)#
}#
#
logor.sq.gradients <- function(cell.counts, logor = NA) {#
	# returns partial first derivatives of squared logor#
#
	d1 <-  2 * logor.eq(cell.counts, logor=logor) / cell.counts[1]#
	d2 <- -2 * logor.eq(cell.counts, logor=logor) / cell.counts[2]#
	d3 <- -2 * logor.eq(cell.counts, logor=logor) / cell.counts[3]#
	d4 <-  2 * logor.eq(cell.counts, logor=logor) / cell.counts[4]#
	#
	res <- c(d1,d2,d3,d4)#
	#
	return(res)#
}#
#
#
#
gradients<- function(cell.counts, logor, var, #
			row1sum, row2sum, col1sum, col2sum) {#
	# returns the gradients for the cell counts #
	# note that I have to create them from the #
	# six components of the #
	# objective function. 	#
	#
	r1sum.part <- c(0, 0, 0, 0)#
	r1sum.part[c(1,2)] <- 2* (sum(cell.counts[c(1,2)]) - row1sum)#
#
	r2sum.part <- c(0, 0, 0, 0)#
	r2sum.part[c(3,4)] <- 2* (sum(cell.counts[c(3,4)]) - row2sum)#
#
	c1sum.part <- c(0, 0, 0, 0)#
	c1sum.part[c(1,3)] <- 2* (sum(cell.counts[c(1,3)]) - col1sum)#
#
	c2sum.part <- c(0, 0, 0, 0)#
	c2sum.part[c(2,4)] <- 2* (sum(cell.counts[c(2,4)]) - col2sum)#
#
	variance.part <- var.sq.gradients(cell.counts, var = var)#
	logor.part <- logor.sq.gradients(cell.counts, logor = logor)#
	#
	res <- r1sum.part + r2sum.part + c1sum.part + c2sum.part +#
		   variance.part + logor.part #
	#
	return(res)#
}#
#
#
#
#
##############################################
###  binary data #
##############################################
#
# assume that you get the following#
# c11, c12, c21, c22 #
# r1sum = c11 + c12#
# r2sum = c21 + c22#
# c1sum = c11 + c21#
# c2sum = c12 + c22#
# N = c11+c12+c13+c14#
#
#
#
#
#
#
#
#
#
#
#
#
#
#############################################
#
# make a fictitious 2x2#
a <- c(1001, 20, 300, 40)#
# calculate the logor and the variance #
my.logor <- logor.eq(a, logor=NA)#
my.var <- var.eq(a, var=NA)#
my.row1sum <- sum(a[c(1,2)])#
my.row2sum <- sum(a[c(3,4)])#
my.col1sum <- sum(a[c(1,3)])#
my.col2sum <- sum(a[c(2,4)])#
my.total <- sum(a)#
#
result.NM<-optim(rep(my.total/4,4), find.my.cells, gr=NULL, logor=my.logor,var=my.var,#
	row1sum=my.row1sum, row2sum =my.row2sum, col1sum=my.col1sum, col2sum=my.col2sum,#
	method = "Nelder-Mead",#
	control=c(abstol=1e-8, maxit=10000, reltol=0))#
#
result.NM#
#
round(result.NM$par)#
#
#
#result.BFGS<-optim(rep(my.total/4,4), find.my.cells, gradients, logor=my.logor,var=my.var,#
#	row1sum=my.row1sum, row2sum =my.row2sum, col1sum=my.col1sum, col2sum=my.col2sum,#
#	method = "BFGS",#
#	control=c(abstol=1e-8, maxit=10000, reltol=0))#
##
#result.BFGS#
##
#round(result.BFGS$par)
#
# make a fictitious 2x2#
a <- c(1001, 20, 300, 40)#
# calculate the logor and the variance #
my.logor <- logor.eq(a, logor=NA)#
my.var <- var.eq(a, var=NA)#
my.row1sum <- sum(a[c(1,2)])#
my.row2sum <- sum(a[c(3,4)])#
my.col1sum <- sum(a[c(1,3)])#
my.col2sum <- sum(a[c(2,4)])#
my.total <- sum(a)#
#
result.NM<-optim(rep(my.total/4,4), find.my.cells, gr=NULL, logor=my.logor,var=my.var,#
	row1sum=my.row1sum, row2sum =my.row2sum, col1sum=my.col1sum, col2sum=my.col2sum,#
	method = "Nelder-Mead",#
	control=c(abstol=1e-8, maxit=10000, reltol=0))#
#
result.NM#
#
round(result.NM$par)
#
# make a fictitious 2x2#
a <- c(2001, 20, 300, 40)#
# calculate the logor and the variance #
my.logor <- logor.eq(a, logor=NA)#
my.var <- var.eq(a, var=NA)#
my.row1sum <- sum(a[c(1,2)])#
my.row2sum <- sum(a[c(3,4)])#
my.col1sum <- sum(a[c(1,3)])#
my.col2sum <- sum(a[c(2,4)])#
my.total <- sum(a)#
#
result.NM<-optim(rep(my.total/4,4), find.my.cells, gr=NULL, logor=my.logor,var=my.var,#
	row1sum=my.row1sum, row2sum =my.row2sum, col1sum=my.col1sum, col2sum=my.col2sum,#
	method = "Nelder-Mead",#
	control=c(abstol=1e-8, maxit=10000, reltol=0))#
#
result.NM#
#
round(result.NM$par)
506.50+130.62
1813.5-853.5
1317.97-960
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,6)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],6))#
#
	X<- (#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res)#
}
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,6)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],6))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res, my.frame)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	print()my.frame)#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res, my.frame)#
}
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	print(my.frame)#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res, my.frame)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
?colnames
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	colnames(my.frame) <- c("c11", "c12", "c21", "c22", "r1sum", "r2sum", "c1sum", "c2sum", "total" )#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit=TRUE )#
	#
	return(res)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
?lm
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	colnames(my.frame) <- c("c11", "c12", "c21", "c22", "r1sum", "r2sum", "c1sum", "c2sum", "total" )#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame, na.omit )#
	#
	return(res)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
#fillin.2x2.simple <- function(#
#c11=NA, #
#c12=NA, #
#c21=NA, #
#c22=NA, #
##
#r1sum =NA, #
#r2sum=NA, #
#c1sum=NA, #
#c2sum=NA,#
#total=NA, #
##
#prop.c11.r1sum =NA,#
#prop.c11.c1sum =NA,#
##
#prop.c12.r1sum =NA,#
#prop.c12.c2sum =NA,#
##
#prop.c21.r2sum =NA,#
#prop.c21.c1sum =NA,#
##
#prop.c22.r2sum =NA,#
#prop.c22.c2sum =NA,#
##
#prop.r1sum.total =NA, #
#prop.r2sum.total =NA, #
#prop.c1sum.total =NA, #
#prop.c2sum.total =NA,#
##
#touse=rep(TRUE,21)#
#) {#
#}#
#
fillin.2x2.simple <- function(#
c11=NA, #
c12=NA, #
c21=NA, #
c22=NA, #
r1sum =NA, #
r2sum=NA, #
c1sum=NA, #
c2sum=NA,#
total=NA, #
touse=rep(TRUE,9)#
) {#
	y <- c(#
	rep(c11,4), #
	rep(c12,4),#
	rep(c21,4), #
	rep(c22,4),#
	rep(r1sum,3), #
	rep(r2sum,3), #
	rep(c1sum,3), #
	rep(c2sum,3),#
	rep(total,8)) #
#
    select <- c(#
		rep(touse[1],4), #
		rep(touse[2],4), #
		rep(touse[3],4), #
		rep(touse[4],4), #
		rep(touse[5],3), #
		rep(touse[6],3), #
		rep(touse[7],3), #
		rep(touse[8],3), #
		rep(touse[9],8))#
#
	X<- c(#
	# c11, c12, c21, c22, r1sum, r2sum, c1sum, c2sum, total #
	    1,   0,   0,   0,     0,     0,     0,     0,     0,  #c11#
	    0,  -1,   0,   0,     1,     0,     0,     0,     0,  #c11=r1sum-c12#
	    0,   0,  -1,   0,     0,     0,     1,     0,     0,  #c11=c1sum-c21#
	    0,  -1,  -1,  -1,     0,     0,     0,     0,     1,  #c11=total-c12-c21-c22#
#
	    0,   1,   0,   0,     0,     0,     0,     0,     0,  #c12#
	   -1,   0,   0,   0,     1,     0,     0,     0,     0,  #c12=r1sum-c11#
	    0,   0,   0,  -1,     0,     0,     0,     1,     0,  #c12=c2sum-c22#
	   -1,   0,  -1,  -1,     0,     0,     0,     0,     1,  #c12=total-c11-c21-c22#
#
	    0,   0,   1,   0,     0,     0,     0,     0,     0,  #c21#
	    0,   0,   0,  -1,     0,     1,     0,     0,     0,  #c21=r2sum-c22#
	   -1,   0,   0,   0,     0,     0,     1,     0,     0,  #c21=c1sum-c11#
	   -1,  -1,   0,  -1,     0,     0,     0,     0,     1,  #c21=total-c11-c12-c22#
#
	    0,   0,   0,   1,     0,     0,     0,     0,     0,  #c22#
	    0,   0,  -1,   0,     0,     1,     0,     0,     0,  #c22=r2sum-c21#
	    0,  -1,   0,   0,     0,     0,     0,     1,     0,  #c22=c2sum-c12#
	   -1,  -1,  -1,   0,     0,     0,     0,     0,     1,  #c22=total-c11-c12-c21#
	#
	    0,   0,   0,   0,     1,     0,     0,     0,     0,  #r1sum#
	    1,   1,   0,   0,     0,     0,     0,     0,     0,  #r1sum=c11+c12#
	    0,   0,   0,   0,     0,    -1,     0,     0,     1,  #r1sum=total-r2sum#
#
	    0,   0,   0,   0,     0,     1,     0,     0,     0,  #r2sum#
	    0,   0,   1,   1,     0,     0,     0,     0,     0,  #r2sum=c21+c22#
	    0,   0,   0,   0,    -1,     0,     0,     0,     1,  #r2sum=total-r1sum#
	    #
	    0,   0,   0,   0,     0,     0,     1,     0,     0,  #c1sum#
	    1,   0,   1,   0,     0,     0,     0,     0,     0,  #c1sum=c11+c21#
	    0,   0,   0,   0,     0,     0,     0,    -1,     1,  #c1sum=total-c2sum#
#
	    0,   0,   0,   0,     0,     0,     0,     1,     0,  #c2sum#
	    0,   1,   0,   1,     0,     0,     0,     0,     0,  #c2sum=c12+c22#
	    0,   0,   0,   0,     0,     0,    -1,     0,     1,  #c2sum=total-c1sum#
#
	    0,   0,   0,   0,     0,     0,     0,     0,     1,  #total#
	    1,   1,   1,   1,     0,     0,     0,     0,     0,  #total=c11+c12+c21+c22#
	    0,   0,   0,   0,     1,     1,     0,     0,     0,  #total=r1sum+r2sum#
	    0,   0,   0,   0,     0,     0,     1,     1,     0,  #total=c1sum+c2sum#
	    0,   0,   1,   1,     1,     0,     0,     0,     0,  #total=r1sum+c21+c22#
	    1,   1,   0,   0,     0,     1,     0,     0,     0,  #total=r2sum+c11+c12#
	    0,   1,   0,   1,     0,     0,     1,     0,     0,  #total=c1sum+c12+c22#
	    1,   0,   1,   0,     0,     0,     0,     1,     0   #total=c2sum+c11+c21#
		)#
#
	X<-matrix(X,ncol=9, byrow=TRUE)#
	my.frame <- as.data.frame(X)#
	colnames(my.frame) <- c("c11", "c12", "c21", "c22", "r1sum", "r2sum", "c1sum", "c2sum", "total" )#
	#
# add the responses y#
	my.frame <- cbind(y, my.frame)#
	#
	res <- lm(y~ c11 + c12 + c21 + c22 + r1sum + r2sum + #
			  c1sum + c2sum + total + (-1) ,data=my.frame)#
	#
	return(res)#
}
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=1)
fillin.2x2.simple(c11=1,c12=1,c21=1,c22=10)
fillin.2x2.simple(c11=1,c12=1,c21=1)
fillin.2x2.simple(c11=1,c12=1,c21=1, total=5)
fillin.2x2.simple(c11=1,c12=1, total=5)
library(igraph)
??igraph
1908
1908+1933
3841*6
5000/12
3000*26
-14400
78000-14400
/12
78000/12-14400/12
140000/26
140000/12
140000/26
130000/26
130000*.40
140/13
140/130
140/133
140/133 * 3000
3*26/12
6.5-3.2
706 *26
16500/26
45000*1.03^4
3000*26
28000
28000/12
2300+1200
32000
/12
32000/12
32000/12 + 1200
32000/12 + 1200 -3200
700 * 12/26
28000/12 + 1200 -3200
110000
110000/14000
110000/140000
400/.79
140000*1.03^5
3200 * .97^5
123.70+50+12.62+224.74
247.40+36+168.17
247.40+36+168.17+20.67+50
cdf()
source('01_import_graph.r')
plot(G1)
plot(G)
plot(fix.vertex.colors(g1))
plot(fix.vertex.colors(G))
g<-fix.vertex.colors(G)
plot(g)
plot.igraph
g
list.graph.attributes(g)
list.edge.attributes(g)
list.vertex.attributes(g)
V(g)$size
V(g)$color
list.vertex.attributes(g)
V(g)$shape
g1 <- g
plot(g1)
rm(g)
plot(g1)
plot(G)
remove.vertex.attribute(g1, 'shape')
plot(remove.vertex.attribute(g1, 'shape'))
plot(g1)
g<- 1
plot(g1)
plot.igraph
source('citat')
cdf()
source('citation_graph_functions.r')
source('citation_graph_functions.r')
source('citation_graph_functions.r')
source('citation_graph_functions.r')
plot(g1)
source('citation_graph_functions.r')
plot(g1)
source('citation_graph_functions.r')
plot(g1)
environment()
environment(igraph)
environment(library(igraph))
environment(library(igraph))
search()
environment(pakage:igraph)
environment(package:igraph)
environment('package:igraph')
environment('package:igraph')
cdf()
cdf()
dir()
cdf()
flist <- dir('./igraph/R')
flist
sapply(flist, paste('a',flist, sep='')
)
?sapply
flist <- dir('./igraph/R')#
#
f1list <- NULL #
for (i in 1:length(flist)) {#
    f1list <- c(f1list, paste('./igraph/R/', flist[i], sep=''))#
}
f1list
package.skeleton(name='igraph', path=R, code_files=f1list)
package.skeleton(name='igraph', code_files=f1list)
fix(plot.igraph)
plot(g1)
